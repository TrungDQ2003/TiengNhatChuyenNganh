<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanji Memory Master</title>
    <link rel="stylesheet" href="include/HomePage.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body>
    <header>
        <div class="menu-icon" onclick="toggleMenu()">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
        <h1 class="title">Kanji Memory Master</h1>
        <a href="create_course.html"><button class="create-course">+ Create Course</button></a>
        <div class="user-icon" onclick="toggleDropdown()">
            <img style="width: 30px; height: 30px; border-radius: 50%; border: 1px solid black;" src="assets/hehe.jpg"
                alt="Profile Image">
            <div id="dropdown-menu" class="dropdown-menu">
                <a href="account_info.php" class="dropdown-item">
                    <span class="material-icons">person</span> Information
                </a>
                <a href="index.html" class="dropdown-item">
                    <span class="material-icons">logout</span>Log out
                </a>
            </div>
        </div>

    </header>

    <nav class="sidebar" id="sidebar">
        <ul>
            <li class="active" onclick="showSection('home')"><span class="material-icons">home</span> Home</li>
            <li onclick="showSection('library')"><span class="material-icons">folder</span> Your library</li>
            <p>Learn</p>
            <li onclick="showSection('quizzes')"><span class="material-icons">inventory_2</span> Quizzes</li>
        </ul>
    </nav>

    <div class="container" id="container">
        <!-- Course section -->
        <main class="content" id="home-section" style="display: block;">
            <section class="course-section">
                <h2>Your Course</h2>
                <div class="course-list" id="course-list">
                    <!-- <a href="flashcard.html">
                        <div class="course">第二課<br>30 terms <br>😍 longdeepzai</div>
                    </a>
                    <a href="flashcard.html">
                        <div class="course">第三課<br>26 terms <br>😍 longdeepzai</div>
                    </a> -->
                </div>
            </section>
            <section class="favourite-section">
                <h2>Favourite</h2>
                <div class="favourite-list" id="favourite-list">
                    <!-- <a href="flashcard.html">
                        <div class="course">第二課<br>30 terms <br>😍 longdeepzai</div>
                    </a>
                    <a href="flashcard.html">
                        <div class="course">第三課<br>26 terms <br>😍 longdeepzai</div>
                    </a> -->
                </div>
            </section>
            <section class="top-creators-section">
                <h2>Top-creators</h2>
                <div class="creators-list" id="creators-list">
                    <!-- <a href="flashcard.html">
                        <div class="course">第二課<br>30 terms <br>😍 longdeepzai</div>
                    </a>
                    <a href="flashcard.html">
                        <div class="course">第三課<br>26 terms <br>😍 longdeepzai</div>
                    </a> -->
                </div>
            </section>
        </main>

        <!-- Library section  -->
        <main class="content" id="library-section" style="display: none;">
            <h2>Your Library</h2>
            <p>Content related to Your Library...</p>
        </main>

        <!-- Quizzes Section -->
        <main class="content" id="quizzes-section" style="display: none;">
            <section class="quiz-list">
                <h2>List Quizzes</h2>
                <div class="quizzes">
                    <div class="quiz-item" onclick="showQuizScreen()">Quiz 1</div>
                    <div class="quiz-item" onclick="showQuizScreen()">Quiz 2</div>
                    <div class="quiz-item" onclick="showQuizScreen()">Quiz 3</div>
                    <div class="quiz-item" onclick="showQuizScreen()">Quiz 4</div>
                    <div class="quiz-item" onclick="showQuizScreen()">Quiz 5</div>
                    <div class="quiz-item" onclick="showQuizScreen()">Quiz 6</div>
                </div>
            </section>
        </main>

        <!-- Quiz Screen -->
        <main class="content" id="quiz-screen-section" style="display: none;">
            <h2>Quiz</h2>
            <div class="quiz-header">
                <button class="quiz-tab button-active quiz1" onclick="showQuiz('take')">Take Quizzes</button>
                <button class="quiz-tab quiz2" onclick="showQuiz('results')">Show Results</button>
            </div>

            <div class="take-quizzes-body" id="take-quizzes" style="display: block;">
                <div class="quiz-detail">
                    <p>Level: N3</p>
                    <p>Questions: 1/20</p>
                    <p>Time: 15p</p>
                </div>

                <div class="quiz-question">
                    <p>Question 1: What is the Kanji for "water"?</p>
                </div>

                <div class="options">
                    <div>A: 水</div>
                    <div>B: 火</div>
                    <div>C: 土</div>
                    <div>D: 風</div>
                </div>

                <div class="quiz-footer">
                    <button>←</button>
                    <button>Submit</button>
                    <button>→</button>
                </div>
            </div>

            <div class="quiz-results" id="quiz-results" style="display: none;">
                <div class="results-table">
                    <table>
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Exam</th>
                                <th>Point</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>Test 1</td>
                                <td>9/10</td>
                                <td>45 minute</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>Test 2</td>
                                <td>8/10</td>
                                <td>45 minute</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>Test 3</td>
                                <td>7/10</td>
                                <td>45 minute</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>Test 4</td>
                                <td>10/10</td>
                                <td>45 minute</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


        </main>

    </div>

    <!-- footer -->
    <footer>
        <a href="#">Điều khoản dịch vụ</a>
        <a href="#">Hỗ trợ</a>
    </footer>

    <script>
        // Function to fetch and display decks
        async function fetchDecks() {
            try {
                let response = await fetch('fetch_course.php');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                let decks = await response.json();
                displayDecks(decks);
            } catch (error) {
                console.error('Error fetching decks:', error);
            }
        }

        // Function to display decks
        function displayDecks(decks) {
            const courseList = document.getElementById('course-list');
            const favouriteList = document.getElementById('favourite-list');
            const creatorsList = document.getElementById('creators-list');
            courseList.innerHTML = '';
            favouriteList.innerHTML = '';
            creatorsList.innerHTML = '';

            decks.forEach(deck => {
                const deckElement = document.createElement('a');
                deckElement.href = `flashcard.html?deck_id=${deck.deck_id}`;
                deckElement.innerHTML = `
                    <div class="course">
                        ${deck.name}<br>${deck.term_count} terms <br>😍 ${deck.creator}
                    </div>
                `;
                courseList.appendChild(deckElement);

                // Assuming you have a way to determine favourite decks
                if (deck.is_favourite) {
                    const favouriteElement = document.createElement('a');
                    favouriteElement.href = `flashcard.html?deck_id=${deck.deck_id}`;
                    favouriteElement.innerHTML = `
                    <div class="course">${deck.name}<br>${deck.term_count} terms <br>😍 ${deck.creator}</div>
                `;
                    favouriteList.appendChild(favouriteElement);
                }

                // Assuming you have a way to determine top creators decks
                if (deck.is_top_creator) {
                    const creatorElement = document.createElement('a');
                    creatorElement.href = `flashcard.html?deck_id=${deck.deck_id}`;
                    creatorElement.innerHTML = `
                    <div class="course">${deck.name}<br>${deck.term_count} terms <br>😍 ${deck.creator}</div>
                `;
                    creatorsList.appendChild(creatorElement);
                }
            });
        }

        // Fetch and display decks on page load
        window.onload = fetchDecks;

        window.onclick = function (event) {
            if (!event.target.closest('.user-icon')) {
                var dropdownMenu = document.getElementById("dropdown-menu");
                if (dropdownMenu.style.display === "block") {
                    dropdownMenu.style.display = "none";
                }
            }
        }

        function toggleDropdown() {
            var dropdownMenu = document.getElementById("dropdown-menu");
            if (dropdownMenu.style.display === "block") {
                dropdownMenu.style.display = "none";
            } else {
                dropdownMenu.style.display = "block";
            }
        }

        // Close the dropdown when clicking outside
        window.onclick = function (event) {
            if (!event.target.closest('.user-icon')) {
                var dropdownMenu = document.getElementById("dropdown-menu");
                if (dropdownMenu.style.display === "block") {
                    dropdownMenu.style.display = "none";
                }
            }
        }


        // Toggle Sidebar Menu
        function toggleMenu() {
            var sidebar = document.getElementById("sidebar");
            var container = document.getElementById("container");
            sidebar.classList.toggle("active");
            container.classList.toggle("menu-active");
        }

        // Display section
        function showSection(section) {
            document.getElementById("home-section").style.display = "none";
            document.getElementById("library-section").style.display = "none";
            document.getElementById("quizzes-section").style.display = "none";
            document.getElementById("quiz-screen-section").style.display = "none";

            document.getElementById(section + "-section").style.display = "block";
        }

        // Show quiz screen
        function showQuizScreen() {
            showSection('quiz-screen');
        }

        function showQuiz(mode) {
            const quiz1 = document.getElementsByClassName("quiz1")[0]; // Sửa để lấy phần tử đầu tiên
            const quiz2 = document.getElementsByClassName("quiz2")[0]; // Sửa để lấy phần tử đầu tiên
            const takeQuizzes = document.getElementById("take-quizzes");
            const quizResults = document.getElementById("quiz-results");


            // Xóa active class khỏi cả hai nút
            quiz1.classList.remove('button-active');
            quiz2.classList.remove('button-active');

            if (mode === 'take') {
                takeQuizzes.style.display = "block";
                quizResults.style.display = "none";
                quiz1.classList.add('button-active'); // Thêm active cho nút take
            } else if (mode === 'results') {
                takeQuizzes.style.display = "none";
                quizResults.style.display = "block";
                quiz2.classList.add('button-active'); // Thêm active cho nút results
            }
        }

        window.onload = function () {
            const urlParams = new URLSearchParams(window.location.search);
            const section = urlParams.get('section') || 'home';
            showSection(section);
        }


        // Get all option elements
        const options = document.querySelectorAll('.options div');

        // Add click event listener to each option
        options.forEach(option => {
            option.addEventListener('click', function () {
                // Remove 'selected' class from all options
                options.forEach(opt => opt.classList.remove('selected'));
                // Add 'selected' class to the clicked option
                this.classList.add('selected');
            });
        });




        // Add active class to clicked item
        const sidebarItems = document.querySelectorAll('.sidebar ul li');

        sidebarItems.forEach(item => {
            item.addEventListener('click', function () {
                sidebarItems.forEach(el => el.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>

</html>